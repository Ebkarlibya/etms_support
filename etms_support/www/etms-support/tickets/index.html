{% block head_include %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.rtl.min.css" integrity="sha384-+qdLaIRZfNu4cVPK/PxJJEy0B0f3Ugv8i482AKY7gwXwhaCroABd086ybrVKTa0q" crossorigin="anonymous">
{% endblock %}
<div class="tickets-page" dir="{{ 'rtl' if lang=='ar' else lang }}">
    <div class="row">
        <div class="col-md-8">
            <!-- Header -->
            <div class="table-header">
                <h5>{{ company }} {{_("Support")}}</h5>
                {% if frappe.session.user != "Guest" %}
                <button class="btn btn-warning btn-sm" onclick="location.href='/etms-support/new-ticket'">{{_("New Ticket")}}</button>
                {% endif %}
            </div>
            {% if frappe.session.user == "Guest" %}
            <h6>{{_("Login first to create support tickets.")}}</h6>
            {%endif%}
            <!-- Tickets Table -->
            <table class="table">
                <tbody>
                    {% for ticket in tickets %}
                    <tr>
                        <td>
                            <div class="ticket-anchor">
                                <a href="/etms-support/ticket?name={{ticket.name}}">
                                    <div>
                                        <h5>{{ticket.subject}}</h5>
                                        <small>{{ticket.creation.strftime("%b %d, %Y, %H:%M %p")}}</small>
                                    </div>
                                </a>
                            </div>
                        </td>
                        
                            <!-- <span class="badge badge-secondary">{{ticket.issue_type }}</span> -->
                        
                        <td>
                            {% if ticket.status == "Open" %}
                                <span class="badge badge-success">{{_(ticket.status)}}</span>
                            {% elif ticket.status == "Replied" %}    
                                <span class="badge badge-warning">{{_(ticket.status)}}</span>
                            {% else %}
                                <span class="badge badge-danger">{{_(ticket.status)}}</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<style>
    .tickets-page {
        /* width: 65%; */
    }
    .ticket-anchor > a,
    .ticket-anchor > a:hover {
        text-decoration: none;
        color: black;
    }
    .table-header {
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        margin-top: 10px;
        margin-bottom: 30px;
    }
    
    td {
        vertical-align: middle;
    }
    .badge-secondary {
        color: #000;
        background-color: #e6f2ff;
    }
</style>